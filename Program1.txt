# Step 1: Install compatible versions
!pip install numpy==1.23.5
!pip install gensim --upgrade
# Step 2: Import required libraries
import os
import gensim.downloader as api
import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA
from gensim.models import KeyedVectors
from google.colab import drive

# Step 3: Mount Google Drive
drive.mount('/content/drive')

# Step 4: Define model path
model_path = "/content/drive/My Drive/word2vec-google-news-300.model"

# Step 5: Load or download the Word2Vec model
if os.path.exists(model_path):
    print("Model found in Google Drive..Loading")
    word_vectors = KeyedVectors.load(model_path)
else:
    print("Model not found. Downloading Word2Vec model...")
    word_vectors = api.load("word2vec-google-news-300")
    print("Saving model to Google Drive for future use...")
    word_vectors.save(model_path)
    print("Model saved successfully")

print("\nModel Loaded Successfully\n")

# Step 6: Find similar words
print("Top 5 words similar to 'computer':")
similar_words = word_vectors.most_similar("computer", topn=5)
for word, similarity in similar_words:
    print(f"{word}: {similarity:.4f}")

# Step 7: Word vector arithmetic
print("\nPerforming Vector Arithmetic: 'king - man + woman'")
result = word_vectors.most_similar(positive=['king', 'woman'], negative=['man'], topn=1)
print(f"Result: {result[0][0]}")

# Step 8: More arithmetic examples
print("\nMore Examples of Vector Arithmetic:")
examples = [
    ("Paris", "France", "Italy"),
    ("Einstein", "scientist", "painter")
]
for w1, w2, w3 in examples:
    result = word_vectors.most_similar(positive=[w1, w3], negative=[w2], topn=1)
    print(f"{w1} - {w2} + {w3} = {result[0][0]}")
